<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Editor</title>
    <!-- jQuery -->
    <script src="lib/jquery-3.2.1.min.js"></script>

    <!-- Bootstrap -->
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>

    <!-- Blockly -->
    <script src="lib/blockly/blockly_uncompressed.js"></script>

    <!-- Custom Java Generator -->
    <script src="lib/blockly/generators/java.js"></script>
    <script src="lib/blockly/generators/java/logic.js"></script>
    <script src="lib/blockly/generators/java/loops.js"></script>
    <script src="lib/blockly/generators/java/math.js"></script>
    <script src="lib/blockly/generators/java/lists.js"></script>
    <script src="lib/blockly/generators/java/variables.js"></script>
    <script src="lib/blockly/generators/java/text.js"></script>
    <script src="lib/blockly/generators/java/colour.js"></script>
    <script src="lib/blockly/generators/java/procedures.js"></script>
    <script src="lib/blockly/generators/java/network_functions.js"></script>
    <script src="lib/blockly/generators/java/network_constants.js"></script>
    <script src="lib/blockly/generators/java/network_variables.js"></script>

    <!-- Built-in blocks -->
    <script src="lib/blockly/blocks/colour.js"></script>
    <script src="lib/blockly/blocks/lists.js"></script>
    <script src="lib/blockly/blocks/logic.js"></script>
    <script src="lib/blockly/blocks/loops.js"></script>
    <script src="lib/blockly/blocks/math.js"></script>
    <script src="lib/blockly/blocks/procedures.js"></script>
    <script src="lib/blockly/blocks/text.js"></script>
    <script src="lib/blockly/blocks/variables.js"></script>

    <!-- Language -->
    <script src="lib/blockly/msg/js/en.js"></script>

    <!-- socket.io -->
    <script src="lib/socket.io.js"></script>

    <!-- custom blocks -->
    <script src="utils/load_blocks.js"></script>
    <script src="types/load_blocks.js"></script>
    <script src="utils/convertInfo.js"></script>

    <link rel="stylesheet" type="text/css" href="utils/css/editor.css" />
</head>
<body>
<nav class="navbar navbar-default" style="margin-bottom: 0px">
    <div class="container-fluid">
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="#" onclick="$('#TopologyModal').modal()">Show topology</a></li>
                <li><a href="#" onclick="$('#TypeModal').modal()">Define Types</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>
<table>
    <tr>
        <td id="blocklyArea">
        </td>
    </tr>
</table>

<div id="blocklyDiv" style="position: absolute"></div>

<xml id="toolbox" style="display: none">
    <category name="Logic" colour="210"> </category>
    <sep></sep>
    <category name="Variables" colour="330" custom="VARIABLE"></category>
    <category name="Functions" colour="290" custom="PROCEDURE"></category>
    <category name="Types" colour="120" custom="TYPE"></category>
</xml>

<!-- Modal -->
<div class="modal fade" id="VariableModal" tabindex="-1" role="dialog" aria-labelledby="VariableModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="cancal_variable()"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="VariableModalLabel">Create new variables</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="variable_type">Type: </label>
                    <select class="form-control" id="variable_type">
                        <option value="int">Integer</option>
                        <option value="double">Decimal</option>
                        <option value="String">String</option>
                        <option value="String[]">StaticRoute</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="variable_name">Name: </label>
                    <input id="variable_name" class="form-control" placeholder="Variable Name">
                </div>
                <div class="form-group">
                    <input type="checkbox" id="confirm_variable" hidden>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="cancal_variable();">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="create_variable();">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="TopologyModal" tabindex="-1" role="dialog" aria-labelledby="TopologyModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="cancal_static_route()"><span aria-hidden="true">x</span></button>
                <h4 class="modal-title"  id="TopologyModalLabel">Topology</h4>
                <label id="staticRoute">Static Route: </label>
            </div>
            <div class="modal-body" id="TopologyModalBody">
                <div class="form-group">
                    <input type="checkbox" id="confirm_static_route" hidden>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="cancal_static_route()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="create_static_route()">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="TypeModal" tabindex="-1" role="dialog" aria-labelledby="TypeModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="cancal_static_route()"><span aria-hidden="true">x</span></button>
                <h4 class="modal-title"  id="TypeModalLabel">Type</h4>
                <label id="TypeDefinition" >Define Types: </label>
            </div>
            <div class="modal-body" id="TypeModalBody" style="height: 480px; height: 640px;">
                <iframe id="typeIframe" src="types.html" style="height: 100%; width: 100%"></iframe>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="cancal_static_route()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="create_static_route()">Save changes</button>
            </div>
        </div>
    </div>
</div>
<script src="utils/render_topology.js"></script>

<!-- d3 -->
<script src="lib/d3.min.js"></script>

<!-- editor.js -->
<script src="utils/editor.js"></script>

<script>
  workspace.addChangeListener(Blockly.Types.typeCallback);
  var iframe = document.getElementById('typeIframe');
  Blockly.Types = iframe.contentWindow.Blockly.Types;
</script>
</body>
</html>
